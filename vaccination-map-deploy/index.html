<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Карта вакцинації — Івано-Франківська область</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="data.js"></script>
  <style>
    html, body, #map { height: 100%; margin: 0; padding: 0; }
    .info-window-content h3 { margin: 0; font-size: 16px; }
    .info-window-content p  { margin: 4px 0; font-size: 14px; }
  </style>
</head>
<body>
<div id="map"></div>

<script>
const map = L.map('map').setView([48.62, 24.71], 9);

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  maxZoom: 19,
  attribution: '© OpenStreetMap'
}).addTo(map);

// Іконки для маркерів
const iconBase = 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/';
const shadow   = 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png';

const redIcon   = new L.Icon({iconUrl: iconBase + 'marker-icon-2x-red.png',   shadowUrl: shadow, iconSize:[25,41], iconAnchor:[12,41], popupAnchor:[1,-34], shadowSize:[41,41]});
const greenIcon = new L.Icon({iconUrl: iconBase + 'marker-icon-2x-green.png', shadowUrl: shadow, iconSize:[25,41], iconAnchor:[12,41], popupAnchor:[1,-34], shadowSize:[41,41]});
const blueIcon  = new L.Icon({iconUrl: iconBase + 'marker-icon-2x-blue.png',  shadowUrl: shadow, iconSize:[25,41], iconAnchor:[12,41], popupAnchor:[1,-34], shadowSize:[41,41]});

// Данні про лікарні (укорочено — вставляй весь масив сюди)
const hospitals = [
 {name: 'КНП Надвірнянська ЦРЛ', lat: 48.631315661095655, lng: 24.56020911135381, vaccines: {bcg: 51, hepB: 47.5, dtp: 0, polio: 0, hib: 0, mmr: 0}},
{name: 'ФОП Логоза Надія Богданівна (Медичний центр "L+D medics")', lat: 48.63247664535228, lng: 24.5633747462376, vaccines: {bcg: 0, hepB: 0, dtp: 39.3, polio: 42.9, hib: 32.1, mmr: 57.1}},
{name: 'КНП ЦПМСД Ланчинської СР', lat: 48.5554737, lng: 24.7523396, vaccines: {bcg: 0, hepB: 0, dtp: 56.5, polio: 41.9, hib: 46.8, mmr: 61.3}},
{name: 'КНП Яремчанський ЦПМСД', lat: 48.450393036311624, lng: 24.550963135087944, vaccines: {bcg: 0, hepB: 0, dtp: 94, polio: 78.6, hib: 66.7, mmr: 74.1}},
{name: 'КНП Делятинський ЦПМСД', lat: 48.5277174, lng: 24.6286388, vaccines: {bcg: 0, hepB: 0, dtp: 58.4, polio: 41.6, hib: 61, mmr: 43.4}},
{name: 'КП Надвірнянський НЦПМД', lat: 48.62995882579366, lng: 24.56182212517801, vaccines: {bcg: 0, hepB: 0, dtp: 41.3, polio: 41.3, hib: 38.1, mmr: 57.1}},
{name: 'КНП Переріслянська АЗПСМ', lat: 48.69698130008087, lng: 24.635616216953917, vaccines: {bcg: 0, hepB: 0, dtp: 31.8, polio: 45.5, hib: 81.8, mmr: 50}},
{name: 'КНП Дитяча лікарня Надвірнянського району', lat: 48.63360360735025, lng: 24.555413595435088, vaccines: {bcg: 0, hepB: 0, dtp: 39.1, polio: 43, hib: 41.4, mmr: 41.4}},
{name: 'КП Пасічнянський НЦПМСД', lat: 48.571404219911116, lng: 24.423111496125, vaccines: {bcg: 0, hepB: 0, dtp: 59.7, polio: 96.8, hib: 33.9, mmr: 55.1}},
{name: 'ФОП Гасько Галина Василівна', lat: 48.39773155336226, lng: 24.600112022748004, vaccines: {bcg: 0, hepB: 0, dtp: 61.9, polio: 100, hib: 52.4, mmr: 28.9}},
{name: 'МЦ Лічниця Святого Шарбеля', lat: 48.63528016986135, lng: 24.564949921471847, vaccines: {bcg: 0, hepB: 0, dtp: 0, polio: 0, hib: 100, mmr: 66.7}},
{name: 'КНП Ворохтянська АЗПСМ', lat: 48.2929828, lng: 24.5635786, vaccines: {bcg: 0, hepB: 0, dtp: 76.2, polio: 76.2, hib: 47.6, mmr: 50}},
{name: 'КНП Делятинська міська лікарня планового лікування та реабілітації', lat: 48.5277174, lng: 24.6286388, vaccines: {bcg: 0, hepB: 0, dtp: 70, polio: 30, hib: 90, mmr: 44.4}},
{name: 'КНП Рогатинський ЦПМСД', lat: 49.41538849375909, lng: 24.605406723377534, vaccines: {bcg: 0, hepB: 0, dtp: 56.3, polio: 70.4, hib: 60.6, mmr: 88.7}},
{name: 'КНП Бурштинський мЦПМСД', lat: 49.248760746720755, lng: 24.62754728103857, vaccines: {bcg: 0, hepB: 0, dtp: 64.7, polio: 68.6, hib: 70.6, mmr: 76.5}},
{name: 'КНП Галицький ЦПМСД', lat: 49.11989161624886, lng: 24.737927853726656, vaccines: {bcg: 0, hepB: 0, dtp: 52.2, polio: 53.3, hib: 51.1, mmr: 92.2}},
{name: 'КНП Більшівцівський ЦПМСД', lat: 49.1846632385765, lng: 24.738438203981783, vaccines: {bcg: 0, hepB: 0, dtp: 50, polio: 40, hib: 60, mmr: 107.7}},
{name: 'ФОП Футерко Святослав Володимирович', lat: 49.24982224994117, lng: 24.62806077982613, vaccines: {bcg: 0, hepB: 0, dtp: 94.4, polio: 72.2, hib: 55.6, mmr: 57.9}},
{name: 'ФОП Канюга Святослав Михайлович', lat: 49.12310460806873, lng: 24.726752821658074, vaccines: {bcg: 0, hepB: 0, dtp: 80.8, polio: 61.5, hib: 76.9, mmr: 46.7}},
{name: 'КНП Букачівський ЦПМСД', lat: 49.25093613108748, lng: 24.496349439029, vaccines: {bcg: 0, hepB: 0, dtp: 80, polio: 100, hib: 73.3, mmr: 66.7}},
{name: 'КНП Бурштинська ЦМЛ', lat: 49.24871308377051, lng: 24.627667613581398, vaccines: {bcg: 52.5, hepB: 50.8, dtp: 0, polio: 0, hib: 0, mmr: 0}},
{name: 'КНП Коломийський міський ЦПМСД', lat: 48.52910927129444, lng: 25.040586065645694, vaccines: {bcg: 0, hepB: 0, dtp: 52.4, polio: 45, hib: 51.8, mmr: 49.1}},
{name: 'КНП Коломийський районний ЦПМСД', lat: 48.53017381245797, lng: 25.03851499448202, vaccines: {bcg: 0, hepB: 0, dtp: 67.3, polio: 63.1, hib: 62.7, mmr: 56}},
{name: 'КНП ЦПМСД Нижньовербіж', lat: 48.50930070276943, lng: 25.000045703958815, vaccines: {bcg: 0, hepB: 0, dtp: 48.4, polio: 45.2, hib: 48.4, mmr: 52}},
{name: 'КНП Коломийська ЦРЛ КМР', lat: 48.524811050210936, lng: 25.056834221983085, vaccines: {bcg: 51.7, hepB: 42, dtp: 0, polio: 0, hib: 0, mmr: 0}},
{name: 'КНП Матеївецький ЦПМСД', lat: 48.50298872070025, lng: 25.16437919159841, vaccines: {bcg: 0, hepB: 0, dtp: 95.8, polio: 54.2, hib: 58.3, mmr: 66.7}},
{name: 'ФОП Токарчук О.М. (Медичний центр "Здорова Сім\'я")', lat: 48.52737523608413, lng: 25.059089298066347, vaccines: {bcg: 0, hepB: 0, dtp: 52.3, polio: 49.5, hib: 57, mmr: 64.5}},
{name: 'ФОП Мегединник Ганна Володимирівна', lat: 48.55937901616159, lng: 25.175261307735713, vaccines: {bcg: 0, hepB: 0, dtp: 40, polio: 40, hib: 100, mmr: 100}},
{name: 'ФОП Мельничук Христина Сергіївна', lat: 48.5259211, lng: 25.0380538, vaccines: {bcg: 0, hepB: 0, dtp: 73.1, polio: 50, hib: 92.3, mmr: 44.1}},
{name: 'ФОП Прайс Р.Р.', lat: 48.53433021514356, lng: 25.046667834956644, vaccines: {bcg: 0, hepB: 0, dtp: 62.5, polio: 62.5, hib: 62.5, mmr: 62.5}},
{name: 'КНП Городенківська БЛІЛ', lat: 48.66435396889664, lng: 25.49198568470594, vaccines: {bcg: 50.7, hepB: 58.3, dtp: 0, polio: 0, hib: 0, mmr: 0}},
{name: 'КНП Заболотівська БЛ', lat: 48.468567903555204, lng: 25.28503854236525, vaccines: {bcg: 0, hepB: 0, dtp: 52, polio: 56, hib: 54, mmr: 62}},
{name: 'КНП Снятинський ЦПМСД', lat: 48.4515310037049, lng: 25.55581996666315, vaccines: {bcg: 0, hepB: 0, dtp: 62.3, polio: 57.8, hib: 51.3, mmr: 65.6}},
{name: 'КП Городенківський НЦПМСД', lat: 48.66435130163961, lng: 25.491951090784376, vaccines: {bcg: 0, hepB: 0, dtp: 83.9, polio: 71.3, hib: 92, mmr: 98.9}},
{name: 'ФОП Білик Роман Павлович', lat: 48.468537859144185, lng: 25.28497017144529, vaccines: {bcg: 0, hepB: 0, dtp: 67.3, polio: 61.8, hib: 61.8, mmr: 96.4}},
{name: 'Здорова малеча ФОП Сав\'юк М.Г.', lat: 48.660622945373156, lng: 25.50452947559414, vaccines: {bcg: 0, hepB: 0, dtp: 64.7, polio: 64.7, hib: 52.9, mmr: 55.9}},
{name: 'КНП Верховинська БЛ', lat: 48.15525997768174, lng: 24.811179276434995, vaccines: {bcg: 79.3, hepB: 59.2, dtp: 67.9, polio: 56.6, hib: 62.3, mmr: 53.5}},
{name: 'КНП Яблунівська МЛ', lat: 48.39927438261093, lng: 24.938986117248664, vaccines: {bcg: 0, hepB: 0, dtp: 41.4, polio: 37.1, hib: 45.7, mmr: 42.6}},
{name: 'КНП Косівська ЦРЛ', lat: 48.320119339939275, lng: 25.110305857700165, vaccines: {bcg: 57.4, hepB: 51.8, dtp: 57.6, polio: 45.8, hib: 56.9, mmr: 61.5}},
{name: 'КНП Верховинський ЦПМСД', lat: 48.15582201495217, lng: 24.826572836191723, vaccines: {bcg: 0, hepB: 0, dtp: 58.2, polio: 47.8, hib: 61.2, mmr: 50.8}},
{name: 'КНП АЗПСМ Рожнівської сільської ради', lat: 48.3648867, lng: 25.2285814, vaccines: {bcg: 0, hepB: 0, dtp: 44, polio: 16, hib: 32, mmr: 72.7}},
{name: 'КНП Космацька АЗПСМ', lat: 48.329646538252085, lng: 24.814728332133324, vaccines: {bcg: 0, hepB: 0, dtp: 80, polio: 80, hib: 85, mmr: 50}},
{name: 'КНП Кутська МЛ', lat: 48.262810577694644, lng: 25.183117065715468, vaccines: {bcg: 0, hepB: 0, dtp: 51.2, polio: 45.1, hib: 40.2, mmr: 51.2}},
{name: 'ФОП Магнич Вікторія Михайлівна', lat: 48.3158020, lng: 25.0983417, vaccines: {bcg: 0, hepB: 0, dtp: 100, polio: 79.2, hib: 29.2, mmr: 63.6}},
{name: 'ФОП Зітинюк Андрій Петрович', lat: 48.154882747420906, lng: 24.82546285212938, vaccines: {bcg: 0, hepB: 0, dtp: 85.7, polio: 42.9, hib: 85.7, mmr: 66.7}},
{name: 'ФОП Кімейчук Н.Д.', lat: 48.155349742493584, lng: 24.831635794531305, vaccines: {bcg: 0, hepB: 0, dtp: 58.3, polio: 41.7, hib: 75, mmr: 41.7}},
{name: 'КНП Білоберізька АЗПСМ', lat: 48.14635028340966, lng: 25.0682933018426, vaccines: {bcg: 0, hepB: 0, dtp: 70, polio: 80, hib: 80, mmr: 78.6}},
{name: 'ФОП Скуматчук Людмила Михайлівна', lat: 48.15488693401929, lng: 24.818199545315185, vaccines: {bcg: 0, hepB: 0, dtp: 80, polio: 80, hib: 100, mmr: 66.7}},
{name: 'КНП Яблуницька АЗПСМ', lat: 48.031109667936626, lng: 24.91665869217186, vaccines: {bcg: 0, hepB: 0, dtp: 61.3, polio: 48.4, hib: 64.5, mmr: 50}},
{name: 'КНП ІФ ОПЦ', lat: 48.916140628877244, lng: 24.705675951519613, vaccines: {bcg: 49.2, hepB: 48.6, dtp: 0, polio: 0, hib: 0, mmr: 0}},
{name: 'КНП ЦПМСД ІФ МР', lat: 48.91550145656077, lng: 24.70658313510895, vaccines: {bcg: 64, hepB: 61, dtp: 67, polio: 63, hib: 59, mmr: 65}},
{name: 'КНП Олешанська ЛАЗПСМ', lat: 48.83390667158416, lng: 25.135895806982287, vaccines: {bcg: 0, hepB: 0, dtp: 56.6, polio: 54.7, hib: 47.2, mmr: 39.6}},
{name: 'КНП Тлумацький ЦПМД', lat: 48.87083874340646, lng: 24.993856984719745, vaccines: {bcg: 0, hepB: 0, dtp: 67.4, polio: 43.8, hib: 59.6, mmr: 39.3}},
{name: 'КНП Тлумацька ЦМЛ', lat: 48.870852857374594, lng: 24.99387844239211, vaccines: {bcg: 59.6, hepB: 61.1, dtp: 0, polio: 0, hib: 0, mmr: 0}},
{name: 'КНП ЦПМСД селище Обертин', lat: 48.69346918140228, lng: 25.173483773694585, vaccines: {bcg: 0, hepB: 0, dtp: 47.8, polio: 56.5, hib: 73.9, mmr: 39.1}},
{name: 'КНП ЦПМКДД', lat: 48.92723498268694, lng: 24.72254881965365, vaccines: {bcg: 0, hepB: 0, dtp: 60.1, polio: 54.1, hib: 38.2, mmr: 46.9}},
{name: 'ФОП Кабан В.Б. (OMED Clinic)', lat: 48.90455545114018, lng: 24.68047248263537, vaccines: {bcg: 0, hepB: 0, dtp: 59.5, polio: 50, hib: 81, mmr: 73.3}},
{name: 'ФОП Костирко Н.І. (Станіславська приватна клініка)', lat: 48.92205150860253, lng: 24.697580870387863, vaccines: {bcg: 0, hepB: 0, dtp: 65.5, polio: 67.2, hib: 60.3, mmr: 51.7}},
{name: 'ТзОВ Нейро Глобал (Лікувально-діагностичний центр NeuroGlobal)', lat: 48.90839305112232, lng: 24.67551100051653, vaccines: {bcg: 0, hepB: 0, dtp: 26.4, polio: 25.5, hib: 41.8, mmr: 35.5}},
{name: 'ФОП Пілецька Л.І.(Медична практика "Медікум Plus")', lat: 48.91009101007715, lng: 24.70267055260061, vaccines: {bcg: 0, hepB: 0, dtp: 36.4, polio: 39.4, hib: 30.3, mmr: 27.3}},
{name: 'ТОВ Вест МЕДІКАЛ', lat: 48.92633165633879, lng: 24.721952786685613, vaccines: {bcg: 0, hepB: 0, dtp: 27.3, polio: 9.1, hib: 27.3, mmr: 50}},
{name: 'ТОВ Перша Приватна дитяча поліклініка', lat: 48.92525191138656, lng: 24.7122015926613, vaccines: {bcg: 0, hepB: 0, dtp: 34.3, polio: 66.7, hib: 31.5, mmr: 49.4}},
{name: 'ФОП Бенько Г.С.', lat: 48.909978229685436, lng: 24.688718685082563, vaccines: {bcg: 0, hepB: 0, dtp: 85.7, polio: 87, hib: 98.7, mmr: 90.9}},
{name: 'ФОП Венгрович В.В. (Приватна медична практика "Консул")', lat: 48.927410223650924, lng: 24.714857642736565, vaccines: {bcg: 0, hepB: 0, dtp: 54.2, polio: 58.3, hib: 104.2, mmr: 50}},
{name: 'ЛДЦ Святого Луки', lat: 48.930254376437425, lng: 24.71128095311261, vaccines: {bcg: 0, hepB: 0, dtp: 85, polio: 85, hib: 85, mmr: 44.3}},
{name: 'ФОП Федорин І.Я.', lat: 48.912068843961706, lng: 24.7203395687699, vaccines: {bcg: 0, hepB: 0, dtp: 100, polio: 100, hib: 80, mmr: 40}},
{name: 'ТОВ НОБІ НОБІ (ФОП Олексюк А.)', lat: 48.92121592564007, lng: 24.698586273603592, vaccines: {bcg: 0, hepB: 0, dtp: 80.7, polio: 85.5, hib: 84.3, mmr: 76.9}},
{name: 'ФОП Орловська Р.М. (Медичний центр LifeLine)', lat: 48.91068242780774, lng: 24.678956574339143, vaccines: {bcg: 0, hepB: 0, dtp: 60, polio: 60, hib: 80, mmr: 35}},
{name: 'ТзОВ ЛДМЦ ВІТА (Медичний центр «Віта»)', lat: 48.911694453645175, lng: 24.764319216253302, vaccines: {bcg: 0, hepB: 0, dtp: 20, polio: 30, hib: 80, mmr: 9.1}},
{name: 'ТзОВ Медекс плюс (Лікувально-діагностичний центр "Медекс Плюс")', lat: 48.927940010777405, lng: 24.71199899913081, vaccines: {bcg: 0, hepB: 0, dtp: 100, polio: 100, hib: 88.9, mmr: 50}},
{name: 'ФОП Сем’янчук В.Б. (Медичний центр «VISE clinic»)', lat: 48.90433988777835, lng: 24.701456495568795, vaccines: {bcg: 0, hepB: 0, dtp: 62.5, polio: 93.8, hib: 106.2, mmr: 47.4}},
{name: 'КНП Міська клінічна лікарня №1 ІФ МР', lat: 48.91248937921795, lng: 24.704497145388732, vaccines: {bcg: 78, hepB: 75, dtp: 81, polio: 77, hib: 73, mmr: 79}},
{name: 'ФОП Заяць І. Мій сімейний лікар', lat: 48.936860037030016, lng: 24.690066198312387, vaccines: {bcg: 0, hepB: 0, dtp: 71.4, polio: 71.4, hib: 114.3, mmr: 64.3}},
{name: 'КНП ЦПМСД Болехів', lat: 49.067818716957404, lng: 23.855611449510633, vaccines: {bcg: 0, hepB: 0, dtp: 36, polio: 43, hib: 46.5, mmr: 46.5}},
{name: 'КНП Долинський ЦПМД', lat: 48.97144192856852, lng: 23.99219963313249, vaccines: {bcg: 0, hepB: 0, dtp: 46, polio: 44.2, hib: 45.1, mmr: 37.1}},
{name: 'КНП Вигодський ЦПМД', lat: 48.92858719909366, lng: 23.900398914209273, vaccines: {bcg: 0, hepB: 0, dtp: 29.4, polio: 5.9, hib: 35.3, mmr: 64.7}},
{name: 'КНП Долинська БЛ', lat: 48.972401969124334, lng: 23.992880686063895, vaccines: {bcg: 52.0, hepB: 27.6, dtp: 0, polio: 0, hib: 0, mmr: 0}},
{name: 'КНП АЗПСМ Витвицької ТГ', lat: 48.962733726124455, lng: 23.806499397488594, vaccines: {bcg: 0, hepB: 0, dtp: 44.4, polio: 44.4, hib: 33.3, mmr: 72.2}},
{name: 'КНП Вигодська МБЛ', lat: 48.928469, lng: 23.899824, vaccines: {bcg: 0, hepB: 0, dtp: 0, polio: 0, hib: 0, mmr: 100}},
{name: 'ФОП Константа Софія Володимирівна', lat: 49.06776358167077, lng: 23.85538444308815, vaccines: {bcg: 0, hepB: 0, dtp: 100, polio: 50, hib: 50, mmr: 33.3}},
{name: 'ФОП Зелінська (МЕДХОЛ)', lat: 48.98039792613124, lng: 23.972818013479674, vaccines: {bcg: 0, hepB: 0, dtp: 46.6, polio: 42.5, hib: 67.1, mmr: 54.7}},
{name: 'КНП Калуська ЦРЛ', lat: 49.039292183823136, lng: 24.42740318280626, vaccines: {bcg: 51.8, hepB: 30, dtp: 0, polio: 0, hib: 0, mmr: 0}},
{name: 'КНП Калуський мЦПМСД', lat: 49.04154988119016, lng: 24.353924982079587, vaccines: {bcg: 0, hepB: 0, dtp: 69.3, polio: 69, hib: 69.7, mmr: 77.7}},
{name: 'КНП ЦПМСД Верхнянської СР', lat: 49.09851000714262, lng: 24.29268413716219, vaccines: {bcg: 0, hepB: 0, dtp: 40, polio: 40, hib: 80, mmr: 60}},
{name: 'КНП Войнилівський ЦПМСД', lat: 49.13379923031494, lng: 24.49687180052562, vaccines: {bcg: 0, hepB: 0, dtp: 58.3, polio: 58.3, hib: 62.5, mmr: 56.5}},
{name: 'КНП ЦПМСД Новицької СР', lat: 48.95677333937933, lng: 24.337828305957057, vaccines: {bcg: 0, hepB: 0, dtp: 41.9, polio: 25.8, hib: 32.3, mmr: 64.5}},
{name: 'ТзОВ МЕДЮНІОН', lat: 49.03038179058153, lng: 24.3594038, vaccines: {bcg: 0, hepB: 0, dtp: 50, polio: 65.6, hib: 21.9, mmr: 50}},
{name: 'ФОП Картушова Анна Олегівна (Family clinic)', lat: 49.02967153026346, lng: 24.363418946710574, vaccines: {bcg: 0, hepB: 0, dtp: 53.1, polio: 57.1, hib: 62.2, mmr: 55.1}},
{name: 'ФОП Обрізко Оксана Михайлівна', lat: 49.04127071022772, lng: 24.354115529635127, vaccines: {bcg: 0, hepB: 0, dtp: 72, polio: 100, hib: 100, mmr: 92}},
{name: 'ФОП Іванюк Надія Степанівна (Медлайф)', lat: 49.02982499107063, lng: 24.36544073233268, vaccines: {bcg: 0, hepB: 44, dtp: 84, polio: 68, hib: 76, mmr: 92}},
{name: 'КНП Богородчанська ЦЛ', lat: 48.811537371297106, lng: 24.544374433731534, vaccines: {bcg: 55.9, hepB: 54.9, dtp: 0, polio: 0, hib: 0, mmr: 0}},
{name: 'КНП Лисецька лікарня', lat: 48.86777165352391, lng: 24.61322644020338, vaccines: {bcg: 0, hepB: 0, dtp: 38.5, polio: 19.2, hib: 50, mmr: 83.3}},
{name: 'КНП Тисменицька міська лікарня', lat: 48.90039070165385, lng: 24.845364346534033, vaccines: {bcg: 0, hepB: 0, dtp: 59.7, polio: 61.2, hib: 61.2, mmr: 68}},
{name: 'КНП Єзупільська МЛ', lat: 49.04344117782626, lng: 24.784193329138244, vaccines: {bcg: 0, hepB: 0, dtp: 81.5, polio: 55.6, hib: 63, mmr: 51.7}},
{name: 'КНП ЦПМСД Ямницької СР', lat: 48.99339792299908, lng: 24.706902524448505, vaccines: {bcg: 0, hepB: 0, dtp: 80, polio: 45, hib: 80, mmr: 63.3}},
{name: 'КНП Дзвиняцький ЦПМСД', lat: 48.74534423565659, lng: 24.428707938522045, vaccines: {bcg: 0, hepB: 0, dtp: 56.5, polio: 56.5, hib: 60.9, mmr: 56.5}},
{name: 'КП ЦПМСД Угринівської СР', lat: 48.95960927046301, lng: 24.689518292295805, vaccines: {bcg: 0, hepB: 0, dtp: 33.3, polio: 33.3, hib: 66.7, mmr: 75}},
{name: 'КНП Загвіздянське ЦПМСД', lat: 48.924678013420504, lng: 24.655399696850186, vaccines: {bcg: 0, hepB: 0, dtp: 41.9, polio: 41.9, hib: 38.7, mmr: 64.3}},
{name: 'КНП ЦПМД Богородчанської СР', lat: 48.81259410703235, lng: 24.54483322326459, vaccines: {bcg: 0, hepB: 0, dtp: 74.6, polio: 71.8, hib: 84.5, mmr: 65.3}},
{name: 'КНП Солотвинська лікарня', lat: 48.70586735845858, lng: 24.415974403074372, vaccines: {bcg: 0, hepB: 0, dtp: 100, polio: 0, hib: 100, mmr: 33.3}},
{name: 'КНП Старобогородчанська НАГП', lat: 48.8301183192752, lng: 24.526471826085604, vaccines: {bcg: 0, hepB: 0, dtp: 60, polio: 20, hib: 20, mmr: 100}},
{name: 'ФОП Лисіцька Олександра Миколаївна', lat: 48.880172806757045, lng: 24.596118319091023, vaccines: {bcg: 0, hepB: 0, dtp: 72.7, polio: 81.8, hib: 54.5, mmr: 72.7}},
{name: 'ФОП Попіна І.О.', lat: 48.995965, lng: 24.188822, vaccines: {bcg: 0, hepB: 0, dtp: 66.7, polio: 83.3, hib: 100, mmr: 72.7}},
{name: 'ФОП Карпінець Олександра Дмитрівна', lat: 48.86102878913901, lng: 24.579176974208032, vaccines: {bcg: 0, hepB: 0, dtp: 16.7, polio: 33.3, hib: 33.3, mmr: 66.7}},
{name: 'КНП ІФ ОПЦ', lat: 48.916140628877244, lng: 24.705675951519613, vaccines: {bcg: 78, hepB: 75, dtp: 81, polio: 77, hib: 73, mmr: 79}},
{name: 'Рожнятівська БЛ', lat: 48.934505, lng: 24.147820, vaccines: {bcg: 50.8, hepB: 24.9, dtp: 0, polio: 0, hib: 0, mmr: 0}},
{name: 'Рожнятівський ЦПМД', lat: 48.935377, lng: 24.151166, vaccines: {bcg: 0, hepB: 0, dtp: 52.2, polio: 31.7, hib: 45.6, mmr: 45.6}},
{name: 'Ів-Франк. МКПЦ', lat: 48.915341, lng: 24.704682, vaccines: {bcg: 49.3, hepB: 46.5, dtp: 0, polio: 0, hib: 0, mmr: 0}},
{name: 'Ів-Франк. ОДКЛ', lat: 48.907339, lng: 24.711940, vaccines: {bcg: 0, hepB: 0, dtp: 100, polio: 133.3, hib: 200, mmr: 80}},
{name: 'Брошнів-Осадська МЛ', lat: 48.993238, lng: 24.184329, vaccines: {bcg: 0, hepB: 0, dtp: 42.9, polio: 42.9, hib: 46.9, mmr: 50}},
{name: 'КНП ЦПМД ІФ МР', lat: 48.918724, lng: 24.711257, vaccines: {bcg: 0, hepB: 0, dtp: 60, polio: 64, hib: 76, mmr: 61.3}},
{name: 'КНП ЦПМСД ІФ МР', lat: 48.91550145656077, lng: 24.70658313510895, vaccines: {bcg: 64, hepB: 61, dtp: 67, polio: 63, hib: 59, mmr: 65}}];

// Визначення кольору іконки на основі середнього відсотка вакцинації
function iconByVaccines(vaccines) {
  const average = calculateAverage(vaccines);
  if (average < 50) return blueIcon;
  if (average < 65) return greenIcon;
  return redIcon;
}

// Розрахунок середнього відсотка вакцинації (тільки для наданих вакцин)
function calculateAverage(vaccines) {
  const values = Object.values(vaccines).filter(value => value !== null && value !== undefined && value !== 0 && value !== '');
  if (values.length === 0) return 0;
  const sum = values.reduce((acc, val) => acc + val, 0);
  return Math.round(sum / values.length);
}

// Форматування значення вакцини для відображення
function formatVaccineValue(value) {
  return (value === null || value === undefined || value === 0 || value === '') ? 'N/A' : `${value}%`;
}

// Додавання маркерів
hospitals.forEach(h => {
  const avgCoverage = calculateAverage(h.vaccines);
  L.marker([h.lat, h.lng], {icon: iconByVaccines(h.vaccines)}).addTo(map)
    .bindPopup(`<div class="info-window-content">
      <h3>${h.name}</h3>
      <p><b>Середнє охоплення вакцинацією:</b> ${avgCoverage}%</p>
      <ul style="margin: 8px 0; padding-left: 20px;">
        <li><b>БЦЖ:</b> ${formatVaccineValue(h.vaccines.bcg)}</li>
        <li><b>Геп В-1 до року:</b> ${formatVaccineValue(h.vaccines.hepB)}</li>
        <li><b>АКДП-3 (до року):</b> ${formatVaccineValue(h.vaccines.dtp)}</li>
        <li><b>Поліо-3 до року:</b> ${formatVaccineValue(h.vaccines.polio)}</li>
        <li><b>Нів-2 до року:</b> ${formatVaccineValue(h.vaccines.hib)}</li>
        <li><b>КПК-1 1р.:</b> ${formatVaccineValue(h.vaccines.mmr)}</li>
      </ul>
    </div>`);
});

// === Районні межі видалені - показуємо тільки межі області ===

// Фільтрування GeoJSON даних для знаходження Івано-Франківської області
const ivanoFrankivskOblast = geojsonData.features.find(feature => 
  feature.properties && 
  (feature.properties.shapeName === "Ivano-Frankivsk Oblast" || 
   feature.properties.shapeName === "Івано-Франківська область" ||
   feature.properties.shapeISO === "UA-26")
);

// Функція для обробки кожного об'єкта GeoJSON
function onEachFeature(feature, layer) {
  if (feature.properties && feature.properties.shapeName) {
    layer.bindPopup(`<div class="info-window-content">
      <h3>${feature.properties.shapeName}</h3>
      <p><strong>ISO код:</strong> ${feature.properties.shapeISO}</p>
      <p><strong>Тип:</strong> ${feature.properties.shapeType}</p>
    </div>`);
  }
}

// Додавання кордонів Івано-Франківської області
if (ivanoFrankivskOblast) {
  L.geoJSON(ivanoFrankivskOblast, {
    style: { color: 'red', weight: 5, fillOpacity: 0.1 },
    onEachFeature: onEachFeature
  }).addTo(map);
  console.log('Івано-Франківська область знайдена та додана на карту');
} else {
  console.error('Івано-Франківська область не знайдена в geojsonData');
}
</script>
</body>
</html>
